<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Senior's Allowance Program 2025</title>

  <link rel="stylesheet" href="./styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/react-toastify/8.2.0/ReactToastify.min.css" />

  <!-- Ringba -->
  <script src=//b-js.ringba.com/CA1a16b597ee204279b113debdbea8413c async></script>

  <style>.hidden{display:none;}</style>

  <!-- Start NB Pixel Snippet -->
  <script>
    !(function (e, n, t, i, p, a, s) {
      e[i] ||
        (((p = e[i] =
          function () {
            p.process ? p.process.apply(p, arguments) : p.queue.push(arguments);
          }).queue = []),
        (p.t = +new Date()),
        ((a = n.createElement(t)).async = 1),
        (a.src = 'https://static.newsbreak.com/business/tracking/nbpixel.js?t=' + 864e5 * Math.ceil(new Date() / 864e5)),
        (s = n.getElementsByTagName(t)[0]).parentNode.insertBefore(a, s));
    })(window, document, 'script', 'nbpix'),
      nbpix('init', 'ID-1969942475367669762'),
      nbpix('event', 'pageload');
  </script>
  <!-- End NB Pixel Snippet -->
</head>
<body>
  <div>
    <div style="margin-bottom: 4px; font-family: Arial, Helvetica, sans-serif;" class="top-sticky-blue-test2" id="top">
      Senior's Allowance Program 2025
    </div>

    <!-- Step messages -->
    <div class="checking hidden" style="font-weight:700;" id="status">
      <span id="statusMessage"></span>
    </div>

    <!-- Main content -->
    <div class="main-container-5" id="mainContent">
      <div class="main-descrition-5-5">
        <div class="main-des-title-6-7"><b>Seniors On Medicare May Qualify For Additional $168/Month Under This New Program!</b></div>
        <img class="topic-img-middle-z" src="./card.png" alt="head" />
        <div style="margin-top:14px;" class="main-des-5">
          Eligible Americans are taking advantage of this opportunity to secure their $168 Monthly Allowance, which covers the cost of groceries, rent, bills, and other monthly expenses.
        </div>
        <div class="main-des-5" style="margin-top:-5px;">
          Use your allowance at your favorite places like Walmart, Target, CVS, and many more. Answer the questions below to check your eligibility now!
        </div>
      </div>

      <div class="survey">
        <div class="quiz-5" id="btn">
          <span id="quizQuestion">1. What's Your Age Range?</span>
        </div>
        <div class="answer" id="answerOptions">
          <!-- Buttons will be injected by JS (functionality only) -->
        </div>
      </div>
    </div>

    <!-- Congratulations -->
    <div class="checking hidden" id="congratulations">
      <div class="congrats">Congratulations, You Qualify!</div>
      <div class="top-description-5">
        Make A <b>Quick Call</b> To Claim Your $168 Monthly Allowance!
      </div>
      <div class="spots-count">Spots remaining: 4</div>
      <div class="tap-direction">ðŸ‘‡ TAP BELOW TO CALL ðŸ‘‡</div>

      <div class="call-btn">
        <a id="callLink" href="tel:+13236897861" style="text-decoration:none; color:inherit;">
          CALL (323) 689-7861
        </a>
      </div>

      <div class="sub-title">We Have Reserved Your Spot</div>
      <div class="sub-description">
        Due to high call volume, your official agent is waiting for only <b>3 minutes</b>, then your spot will not be reserved.
      </div>
      <div class="timer">
        <div class="timer-cell" id="minutes">3</div>
        <div class="timer-cell">:</div>
        <div class="timer-cell" id="seconds">00</div>
      </div>
    </div>

    <div class="footer2">
      <div class="terms2">
        <a href="/terms.html">Terms & Conditions</a> | 
        <a href="/privacy.html">Privacy Policy</a>
      </div>
      <div class="copyright">
        <img src="./dis-desktop.png" class="logo-desktop" alt="Desktop Logo" />
        <img src="./dis-mobile.png" class="logo-mobile" alt="Mobile Logo" />
        This website is operated by a marketing and lead generation company. We are not a government agency, insurance provider, or financial institution. Our role is to connect consumers with licensed professionals, carriers, or service providers who can discuss available options. We do not make eligibility determinations or provide coverage, financing, or government benefits directly.
        <br />
        Copyright Â© 2025 - All rights reserved Daily America Savings.
      </div>
    </div>
  </div>

  <script>
    /* ========= RINGBA / NB HELPERS ========= */
    window._rgba_tags = window._rgba_tags || [];
    const RINGBA_AGE_KEY = 'age';

    /**
     * Push lowercase values to Ringba + mirror to NewsBreak (`newsbreak_cid`)
     * Final object example: { age: '64-69', newsbreak_cid: '64-69' }
     */
    function rbTag(key, value) {
      try {
        const lowerValue = (value || '').toString().trim().toLowerCase();
        window.newsbreak_cid = lowerValue || '';

        const tag = {};
        tag[key === 'age' ? RINGBA_AGE_KEY : key] = lowerValue;
        tag['newsbreak_cid'] = window.newsbreak_cid || '';
        window._rgba_tags.push(tag);

        console.log('[Ringba] pushed (lowercase):', tag, 'â†’ _rgba_tags:', window._rgba_tags);
      } catch (e) {
        console.warn('[Ringba] push failed', e);
      }
    }

    // Age-only helper for compatibility
    function rbAge(value){ rbTag('age', value); }

    /* ========= PHONE NUMBER HANDLING ========= */
    const DEFAULT_NUMBER = '+13236897861';
    const UNDER64_NUMBER = '+18337480815'; // call this when "under 64" is selected
    const callLink = document.getElementById('callLink');

    function formatUS(num) {
      const digits = (num || '').replace(/[^\d]/g, '');
      let core = digits;
      if (digits.length === 11 && digits.startsWith('1')) core = digits.slice(1);
      if (core.length === 10) {
        return `CALL (${core.slice(0,3)}) ${core.slice(3,6)}-${core.slice(6)}`;
      }
      return `CALL ${num}`;
    }

    function updateCallNumber(newNumber) {
      callLink.setAttribute('href', `tel:${newNumber}`);
      callLink.textContent = formatUS(newNumber);
      console.log('[Call Number] updated to', newNumber);
    }

    // initialize with default number
    updateCallNumber(DEFAULT_NUMBER);

    /* ========= QUIZ FLOW ========= */
    const statusDiv = document.getElementById("status");
    const statusMessage = document.getElementById("statusMessage");
    const congratulationsDiv = document.getElementById("congratulations");
    const quizText = document.getElementById("quizQuestion");
    const answerOptions = document.getElementById("answerOptions");

    const minutesEl = document.getElementById("minutes");
    const secondsEl = document.getElementById("seconds");

    const selections = { age:null, us_citizen:null, ab:null };

    const steps = [
      {
        key: 'age',
        question: "1. What's Your Age Range?",
        options: [
          {label:"UNDER 64", value:"under 64"},
          {label:"64-69", value:"64-69"},
          {label:"70-74", value:"70-74"},
          {label:"75+", value:"75+"},
        ],
        onSelect: (val)=> {
          rbAge(val); // pushes lowercase to Ringba + NB
          if ((val || '').toLowerCase().includes('under')) {
            updateCallNumber(UNDER64_NUMBER);
          } else {
            updateCallNumber(DEFAULT_NUMBER);
          }
        }
      },
      {
        key: 'us_citizen',
        question: "2. Do you live in the United States?",
        options: [
          {label:"YES", value:"yes"},
          {label:"NO", value:"no"},
        ],
        onSelect: (val)=> rbTag('us_citizen', val)
      },
      {
        key: 'ab',
        question: "3. Are You Currently Enrolled in Medicare Part A or Part B?",
        options: [
          {label:"YES", value:"yes"},
          {label:"NO", value:"no"},
        ],
        onSelect: (val)=> rbTag('ab', val)
      },
    ];

    let stepIndex = 0;

    function renderStep(){
      const s = steps[stepIndex];
      quizText.textContent = s.question;

      answerOptions.innerHTML = s.options.map((o,i)=>(
        `<div class="answer-btn-5" data-i="${i}">${o.label}</div>`
      )).join('');

      [...answerOptions.children].forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const choice = s.options[+btn.dataset.i];
          handleChoice(s, choice.value);
        });
      });

      smoothScrollToTop(600, 0);
    }

    function handleChoice(step, value){
      selections[step.key] = value;
      if (typeof step.onSelect === 'function') step.onSelect(value);

      if (stepIndex < steps.length - 1){
        stepIndex++;
        renderStep();
      } else {
        stepProcess();
      }
    }

    function smoothScrollToTop(duration, targetPosition = 0) {
      const startPosition = window.pageYOffset;
      const distance = targetPosition - startPosition;
      let startTime = null;

      function animation(currentTime) {
        if (startTime === null) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const run = ease(timeElapsed, startPosition, distance, duration);
        window.scrollTo(0, run);
        if (timeElapsed < duration) requestAnimationFrame(animation);
      }

      function ease(t, b, c, d) {
        t /= d / 2;
        if (t < 1) return (c / 2) * t * t + b;
        t--;
        return (-c / 2) * (t * (t - 2) - 1) + b;
      }

      requestAnimationFrame(animation);
    }

    const stepProcess = () => {
      smoothScrollToTop(600);
      const mainContent = document.getElementById("mainContent");
      mainContent.classList.add("hidden");
      statusDiv.classList.remove("hidden");
      statusMessage.textContent = "Reviewing Your Answers...";

      setTimeout(() => {
        statusMessage.textContent = "Matching With Best Options...";
        setTimeout(() => {
          statusMessage.textContent = "Confirming Eligibility...";
          setTimeout(() => {
            showCongratulations();
          }, 1500);
        }, 1500);
      }, 1500);
    };

    function showCongratulations() {
      statusDiv.classList.add("hidden");
      congratulationsDiv.classList.remove("hidden");
      startTimer();
      setTimeout(() => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }, 100);
    }

    function startTimer() {
      let totalSeconds = 180;
      const timer = setInterval(() => {
        const minutes = Math.floor(totalSeconds / 60);
        const seconds = totalSeconds % 60;
        minutesEl.textContent = minutes;
        secondsEl.textContent = seconds < 10 ? '0' + seconds : seconds;
        totalSeconds--;
        if (totalSeconds < 0) clearInterval(timer);
      }, 1000);
    }

    // NB raw_call on CALL click
    (function attachCallHandler() {
      const link = document.getElementById('callLink');
      if (!link) return;

      function waitForNbpix(maxMs = 2000) {
        return new Promise(resolve => {
          if (typeof window.nbpix === 'function') return resolve(true);
          const start = Date.now();
          const iv = setInterval(() => {
            if (typeof window.nbpix === 'function' || Date.now() - start > maxMs) {
              clearInterval(iv);
              resolve(typeof window.nbpix === 'function');
            }
          }, 50);
        });
      }

      async function fireNbpixRawCall() {
        try {
          const ready = await waitForNbpix();
          if (ready) {
            window.nbpix('event', 'raw_call');
            return true;
          }
        } catch (e) {}
        return false;
      }

      link.addEventListener('click', async function (e) {
        e.preventDefault();
        const href = this.getAttribute('href');
        const fired = await fireNbpixRawCall();
        setTimeout(() => { window.location.href = href; }, fired ? 120 : 180);
      });
    })();

    // start
    renderStep();
  </script>
</body>
</html>
